# Описание системы

К реализации предлагается система учета и анализа данных, поступающих с условного устройства. Полученные данные привязываются к временной метке и устройству, с которого пришли данные, и сохраняются в БД. Набор данных используется для дальнейшего анализа.

## Требования к системе

### Функциональные

- В системе реализован сбор статистики с устройства по его идентификатору в формате {“x”: float, “y”: float, “z”:float}.
- Реализован анализ собранной статистики с устройства за определенный период и за все время.
- Результатами анализа являются числовые характеристики величины: минимальное значение, максимальное значение, количество, сумма, медиана.
- Система поддерживает добавление пользователей устройств.
- В системе реализован функционал получения анализа показаний устройств по идентификатору пользователя:
  - Агрегированные результаты для всех устройств.
  - Для каждого устройства отдельно.

### Нефункциональные

- Архитектура REST.
- Фреймворк реализации сервиса FastApi.
- Собранные данные хранятся в БД на выбор разработчика.
- Сервис и его окружение разворачивается средствами Docker + Docker Compose.

## Установка

### Запуск приложения (на Windows)

- Клонировать репозиторий

```
git clone https://github.com/edgar1148/data_start.git
```

- Установить и активировать виртуальное окружение

```
python -m venv venv
```

```
source venv/Scripts/activate
```

- Для запуска приложения

```
docker compose up
```

# Примеры запросов

## Получение всей статистики для одного пользователя за все время

### Запрос
```
GET /users/1/stats/
```
### Ответ
```
[
    {
        "device_id": 1,
        "device_name": "iphone",
        "analysis_results": {
            "min_value": 10.5,
            "max_value": 20.3,
            "total_count": 2,
            "total_sum": 91.6,
            "median": 15.0
        }
    },
    {
        "device_id": 2,
        "device_name": "macbook",
        "analysis_results": {
            "min_value": 8.2,
            "max_value": 21.4,
            "total_count": 2,
            "total_sum": 94.9,
            "median": 16.950000000000003
        }
    }
]
```

## Получение статистики для устройства пользователя за все время

### Запрос
```
GET /users/2/devices/4/stats/
```
### Ответ
```
{
    "min_value": 7.5,
    "max_value": 19.2,
    "total_count": 2,
    "total_sum": 88.5,
    "median": 17.25
}
```
## Получение статистики для всех устройств за все время

### Запрос
```
GET /devices/5/stats/
```
### Ответ
```
{
    "min_value": 10.4,
    "max_value": 18.9,
    "total_count": 2,
    "total_sum": 84.69999999999999,
    "median": 13.2
}
```
## Получение статистики для устройства за указанный период времени

### Запрос
```
GET /devices/1/stats/?start_time=2024-01-01T00:00:00&end_time=2024-01-02T00:00:00
```
### Ответ
```
{
    "min_value": 10.5,
    "max_value": 20.3,
    "total_count": 2,
    "total_sum": 91.6,
    "median": 15.0
}
```
#### Технологии
- python==3.12.1
- fastapi==0.110.0
- SQLAlchemy==2.0.27

#### Автор
[Евгений Екишев - edgar1148](https://github.com/edgar1148)